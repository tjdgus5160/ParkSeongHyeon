import pandas as pd
import matplotlib.pyplot as plt

# Prompt user to enter file path
# 파일 경로는 내 폴더 들어가서 경로를 입력해서 Excel파일의 이름까지 붙이고 .xlsx까지 붙이면 돼
file_path = input("Enter the file path of the Excel file: ")

# Load Excel file using Pandas
data = pd.read_excel(file_path)

# Extract relevant columns
# 어디 행부터 어디 열까지 지정해서 할 수 있어
x = list(range(1, 4001))
#x = data.iloc[0:51, 24]
y = data.iloc[15:4015, 0]

# Create line graph
fig, ax = plt.subplots(figsize=(20,12))
ax.plot(x, y)

# Plot the data as line graphs with different colors and line styles
ax.plot(x, y, color='blue', linewidth=1)
#ax.plot(x, y2, color='blue', linewidth=2, linestyle='--', label='Polynomial Curve')
#ax.plot(x, y3, color='green', linewidth=1, linestyle=':', label='Random Noise')

#label 글씨크기 키우기
#ax.legend(loc='upper left', fontsize=20)

# Customize the plot
# ax.set_title("Square Wave 0-1V 100kHz", fontsize=30) #fontsize는 글자크기
ax.set_xlabel("Voltage", fontsize=30)
ax.set_ylabel("EIT Signal", fontsize=30)
ax.tick_params(axis='both', which='major', labelsize=20)
ax.tick_params(axis='both', which='minor', labelsize=8)
ax.spines['top'].set_visible(False)
ax.spines['right'].set_visible(False)
ax.spines['bottom'].set_linewidth(1.5)
ax.spines['left'].set_linewidth(1.5)

ax.set_ylim([-20, 120]) # y축 스케일을 -20부터 120까지로 고정합니다.

# Add a grid to the graph with dotted lines, 그래프에 격자그리기
ax.grid(color='gray', linestyle=':', alpha=0.5)

# Add text annotations to the graph, 그래프에 글자넣고 싶을때
#ax.text(-9, 10, 'write_letter', fontsize=14, color='purple')

# Save the figure
fig.savefig('probe lock-in off, coupling 7Hz, 0.6V, FG 1.1Vpp EIT peak shift.png', dpi=500)
# 이미지는 'C:\Users\'에 있음
# 'new_file.png'라고 써있는거는 그 때 그래프 이름을 적으면 됨.
# 근데 한글쓰면 안돼
# 
